## mako
## File:   templates/mathjax_arabic_config.html
##
## Include the arabic.js MathJax extension that allows rendering beautiful Arabic math.
##

<script type="text/x-mathjax-config">
    ## Define the "Contrib" repo for MathJax extensions
    ## This should be later moved to `"//cdn.mathjax.org/mathjax/contrib"`
    MathJax.Ajax.config.path["Contrib"] = "//edraak.github.io/arabic-extension-static";

    MathJax.Hub.Config({
        extensions: [
            "[Contrib]/arabic/arabic.js"
        ]
    });

    ## Hack #1: The `arabic.js` isn't playing well with MathJax v2.6 within the studio
    ## This hack solves it by copying the configs from the arabic.js extension
    ## Not sure why!
    MathJax.Hub.Config({
        'HTML-CSS': {
            undefinedFamily: 'Amiri',
            styles: {
                '.mfliph': {
                    'display': 'inline-block !important',
                    '-moz-transform': 'scaleX(-1)',
                    '-webkit-transform': 'scaleX(-1)',
                    '-o-transform': 'scaleX(-1)',
                    'transform': 'scaleX(-1)',
                    '-ms-filter': 'fliph',
                    'filter': 'fliph'
                },
                '.mar': {
                    'font-family': 'Amiri !important',
                    'font-style': 'normal !important'
                }
            }
        }
    });
</script>

## The Amiri font is more beautiful for Math
<link href="//fonts.googleapis.com/css?family=Amiri&amp;subset=arabic" rel="stylesheet" type="text/css">

<style type="text/css">
    ##  Hack #2
    ##  Arabic Droid Naskh is not playing well with MathJax `spans`
    ##  This style makes sure that the spans in a MathJax element gets the
    ##  `sans-serif` font family instead of Arabic Droid Naskh
    .naskhfixup > span > span {
        font-family: sans-serif;
    }

    ## Hack #3
    ## Proper alignment for equations in Arabic
    body.rtl .MathJax_Display > .MathJax {
        text-align: right;
    }

</style>

<script type="text/x-mathjax-config">
    ##  Hack #2
    MathJax.Hub.Register.MessageHook("End PreProcess", function () {
        ##  This scripts applys the fixup style for the Droid Naskh
        $('.MathJax_Preview')
            .closest('p')
            .addClass('naskhfixup');
    });
</script>
